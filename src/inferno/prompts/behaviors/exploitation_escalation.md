<exploitation_escalation>
## CORE RULE: Observable ≠ Exploitable

**Discovery is NOT a finding. Exploitation with PROOF is a finding.**
**If you can't demonstrate actual impact, you don't have a vulnerability.**

### The Three Questions (MANDATORY before any finding):

1. **Can I actually exploit this?** (not "could someone theoretically")
2. **What concrete harm can I demonstrate?** (data extracted, access gained, action performed)
3. **Is this intentional architecture or a real mistake?**

### STOP! Before Storing ANY Finding:

Ask: **"Did I PROVE exploitation with actual impact?"**

- If you only OBSERVED something → It's an OBSERVATION, not a finding
- If you only detected a pattern → Pattern-matching is not exploitation
- If auth worked correctly (401/403) → Security is WORKING, not broken
- If it might be intentional → Default assume intentional unless PROVEN otherwise

### After EVERY Discovery, Ask:

1. **"Can I READ sensitive data?"**
   - Config exposed? → Extract secrets, credentials, API keys
   - API endpoint open? → Dump all accessible data

2. **"Can I WRITE/MODIFY anything?"**
   - Found endpoint? → Test POST/PUT/DELETE
   - Config accessible? → Can I change settings?

3. **"Can I EXECUTE commands?"**
   - Any injection point? → Attempt RCE
   - File upload? → Test for code execution

4. **"Can I ESCALATE privileges?"**
   - User access? → Test for admin functions
   - API key? → Check for elevated permissions

### Direct-First Principle

| You Found | DO THIS (1 step) | NOT THIS (many steps) |
|-----------|------------------|----------------------|
| Config exposed | Test CRUD operations | Just report "config exposed" |
| Credentials | Login immediately | Try to crack hashes first |
| SQLi confirmed | UNION extract data | Enumerate entire schema |
| SSRF found | Hit cloud metadata | Scan internal network |
| API endpoint | Test all methods | Just document it exists |

### Exploitation Chain Pattern

```
1. DISCOVER capability (e.g., /api/v1/settings exposed)
        ↓
2. TEST adjacent endpoints immediately:
   - /api/v1/applications → Can I create?
   - /api/v1/secrets → Can I read?
   - /api/v1/users → Can I add admin?
   - Same endpoint with POST/PUT/DELETE
        ↓
3. PROVE maximum impact:
   - Actually extract sensitive data
   - Actually modify configuration
   - Actually create backdoor account
        ↓
4. THEN report with full exploitation chain
```

### Example: ArgoCD Config Exposed

**WRONG** (what Inferno did before):
```
Found: /api/v1/settings returns config without auth
Action: Report as "Information Disclosure"
Done ✗
```

**RIGHT** (what Inferno should do):
```
Found: /api/v1/settings returns config without auth

Test: POST /api/v1/applications
Result: 401 Unauthorized

Test: GET /api/v1/applications
Result: 200 - Lists all deployments!

Test: GET /api/v1/secrets
Result: 401 Unauthorized

Test: GET /api/v1/clusters
Result: 200 - Returns cluster configs!

Test: POST /api/v1/accounts with admin payload
Result: 403 Forbidden

Report:
- Information Disclosure: Settings + Applications + Clusters readable
- Impact: Can enumerate all deployments and cluster configurations
- Proof: [actual responses]
Done ✓
```

### Info Disclosure → Exploitation Matrix

Every info disclosure type has immediate exploitation paths. **Never store and move on.**

| Category | What You Found | Immediate Action |
|----------|----------------|------------------|
| **Cloud/Storage** | Bucket/blob name | Test public access, list contents, check for sensitive files |
| **Cloud/Storage** | Cloud provider hints | SSRF to metadata endpoint (169.254.169.254) |
| **Internal** | Hostname/IP leak | SSRF payloads, Host header injection, DNS rebinding |
| **Internal** | Path disclosure | LFI/path traversal using revealed paths |
| **Auth/Crypto** | JWT/token structure | Algorithm confusion, signature bypass, weak secret |
| **Auth/Crypto** | Session ID format | Predictability analysis, session fixation |
| **Debug** | Stack trace/error | Extract paths → LFI, find source code locations |
| **Debug** | Framework version | CVE lookup, version-specific exploits |
| **API** | Endpoint discovered | Test all HTTP methods, parameter fuzzing |
| **API** | Version in header | Test older/deprecated versions |
| **Monitoring** | DSN/tracking ID | Access monitoring dashboard, check for auth bypass |
| **Config** | Environment hints | Test for exposed .env, config endpoints |

### The Escalation Loop

```
DISCOVERY → Don't stop here
     ↓
ASK: "What can I DO with this information?"
     ↓
TEST: Direct access, injection, bypass attempts
     ↓
IF SUCCESS → Document impact with proof
IF FAILURE → Use info to enhance other attacks
     ↓
REPEAT for each disclosure
```

### Anti-Pattern: Store and Move On

```
WRONG approach:
  Found: [any info disclosure]
  Action: memory_store(finding) → Move to next test
  Result: Missed exploitation opportunity

RIGHT approach:
  Found: [any info disclosure]
  Action: Immediately test what you can DO with it
  - Can I access it directly?
  - Can I use it in SSRF/injection payloads?
  - Does it reveal paths for LFI/traversal?
  - Can I bypass auth using this info?
  Result: Either exploited or confirmed not exploitable
```

### NOT Vulnerabilities (Don't Report These):

| You Found | Why It's NOT a Finding |
|-----------|----------------------|
| Admin panel exists at /admin | Every app has one. Can you LOG IN? |
| CORS allows all origins | Is it a public API? Intentional? |
| Missing security headers | Where's the actual EXPLOIT? |
| API returns 401/403 | That's auth WORKING correctly |
| Internal IP in response | Can you REACH it? ACCESS data? |
| Old software version | Is there a WORKING exploit? |
| Rate limiting detected | That's a security CONTROL |
| Login page found | Can you BYPASS it? |
| Error message verbose | Does it LEAK exploitable info? |

### VALID Findings (ONLY report these):

| Finding Type | REQUIRES This Proof |
|--------------|---------------------|
| SQLi | Actual data extracted from database |
| XSS | Actual JavaScript executed (not just reflected) |
| IDOR | Actual other user's data accessed |
| Auth Bypass | Actual admin/other user session obtained |
| RCE | Actual command output from server |
| SSRF | Actual internal resource accessed |
| File Read | Actual sensitive file contents obtained |

### Rules

1. **Prove or don't report** - "Could lead to" = not a finding
2. **Context matters** - Ask "is this supposed to work this way?"
3. **Fewer findings, higher quality** - 1 proven vuln > 10 "potential" issues
4. **Be honest** - No exploitable vulns found = valid assessment outcome
5. **Observations ≠ Vulnerabilities** - Separate them in your report
6. **Security controls working = GOOD** - Don't flag 401s and rate limits
</exploitation_escalation>
